/*! dds-app 09-12-2013 */
"use strict";String.prototype.format=function(){for(var a=this,b=0;b<arguments.length;b++){var c=new RegExp("\\{"+b+"\\}","gi");a=a.replace(c,arguments[b])}return a},angular.module("LocalStorageModule").value("prefix","dds_scholen"),angular.module("ddsApp.controllers",[]),angular.module("ddsApp.services",[]),angular.module("ddsApp.directives",[]),angular.module("ddsApp.filters",[]);var app=angular.module("ddsApp",["ngRoute","ngResource","ddsApp.controllers","ddsApp.services","ddsApp.directives","ddsApp.filters","LocalStorageModule"]).config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){c.defaults.useXDomain=!0,delete c.defaults.headers.common["X-Requested-With"],a.when("/",{templateUrl:"views/main.html",controller:"ddsApp.controllers.MainCtrl",resolve:{weather:appCtrl.loadLocalWeather}}),a.when("/app",{templateUrl:"views/app.html",controller:"AppCtrl",resolve:{appInitialized:appCtrl.loadConfiguration}}),a.otherwise({redirectTo:"/"})}]).run(["$rootScope","$timeout","$location","ddsApp.services.WeatherSrvc",function(a,b,c){a.appInitialized=!1,a.$on("$routeChangeStart",function(){a.appInitialized?a.appInitialized&&"/app"===c.path()&&c.path("/"):c.path("/app")})}]),appCtrl=app.controller("AppCtrl",["$scope","$location","appInitialized",function(a,b,c){c&&b.path("/")}]);appCtrl.loadConfiguration=["$rootScope","$q","$timeout","ddsApp.services.WeatherSrvc",function(a,b,c,d){var e=b.defer();return d.loadConfiguration().then(function(b){c(function(){a.appInitialized=!0,e.resolve(b)},2e3)},function(a){e.reject(a)}),e.promise}],appCtrl.loadLocalWeather=["$rootScope","$q","ddsApp.services.WeatherSrvc",function(a,b,c){var d=b.defer();return c.getGEOLocation().then(function(a){c.loadWeather(a.coords.latitude,a.coords.longitude,"metric").then(function(a){d.resolve(a)},function(a){d.reject(a)})},function(a){d.reject(a)}),d.promise}],function(){var a=angular.module("ddsApp.filters");a.filter("WeatherValueFltr",function(){return function(a,b){var c=parseFloat(a);return c.toFixed(b)}}),a.filter("WeatherDateFilter",function(){return function(a,b){var c=new Date(1e3*a);return $.format.date(c,b)}})}(),function(){var a=angular.module("ddsApp.controllers");a.controller("ddsApp.controllers.MainCtrl",["$scope","weather",function(a,b){a.weather=b,a.getClimaCon=function(a){switch(a){case 801:return" climacon cloud sun";case 804:return" climacon cloud";default:return" climacon sun"}}}])}(),function(){var a=angular.module("ddsApp.services");a.factory("ddsApp.services.WeatherSrvc",["$rootScope","$http","$q","localStorageService",function(a,b,c){var d,e="http://api.openweathermap.org/data/2.5/weather?lat={0}&lon={1}&mode=json&units={2}&callback=JSON_CALLBACK",f="Could not load the Weather call",g="GEO Location not supported";return{loadConfiguration:function(){var a=c.defer();return a.resolve(!0),a.promise},loadWeather:function(a,d,g){var h=c.defer(),i=e.format(a,d,g);return b.jsonp(i).success(function(a){h.resolve(a)}).error(function(){h.reject(f)}),h.promise},getGEOLocation:function(){var a=c.defer();return Modernizr.geolocation?navigator.geolocation.getCurrentPosition(function(b){d=b,a.resolve(b)},function(){a.reject(g)},{timeout:1e4,enableHighAccuracy:!0}):a.reject(g),a.promise}}}])}();