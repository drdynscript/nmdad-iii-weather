/*! dds-app 05-12-2013 */
"use strict";String.prototype.format=function(){for(var formatted=this,i=0;i<arguments.length;i++){var regexp=new RegExp("\\{"+i+"\\}","gi");formatted=formatted.replace(regexp,arguments[i])}return formatted},angular.module("LocalStorageModule").value("prefix","dds_scholen"),angular.module("ddsApp.controllers",[]),angular.module("ddsApp.services",[]),angular.module("ddsApp.directives",[]);var app=angular.module("ddsApp",["ngRoute","ngResource","ddsApp.controllers","ddsApp.services","ddsApp.directives","LocalStorageModule"]).config(["$routeProvider","$locationProvider","$httpProvider",function($routeProvider,$locationProvider,$httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"],$routeProvider.when("/",{templateUrl:"views/main.html",controller:"ddsApp.controllers.MainCtrl",resolve:{weather:appCtrl.loadWeather}}),$routeProvider.when("/app",{templateUrl:"views/app.html",controller:"AppCtrl",resolve:{appInitialized:appCtrl.loadConfiguration}}),$routeProvider.otherwise({redirectTo:"/"})}]).run(["$rootScope","$timeout","$location","ddsApp.services.WeatherSrvc",function($rootScope,$timeout,$location){$rootScope.appInitialized=!1,$rootScope.$on("$routeChangeStart",function(){$rootScope.appInitialized?$rootScope.appInitialized&&"/app"===$location.path()&&$location.path("/"):$location.path("/app")})}]),appCtrl=app.controller("AppCtrl",["$scope","$location","appInitialized",function($scope,$location,appInitialized){appInitialized&&$location.path("/")}]);appCtrl.loadConfiguration=["$rootScope","$q","$timeout","ddsApp.services.WeatherSrvc",function($rootScope,$q,$timeout,WeatherSrvc){var deferred=$q.defer();return WeatherSrvc.loadConfiguration().then(function(data){$timeout(function(){$rootScope.appInitialized=!0,deferred.resolve(data)},2e3)},function(error){deferred.reject(error)}),deferred.promise}],appCtrl.loadWeather=["$rootScope","$q","ddsApp.services.WeatherSrvc",function($rootScope,$q,WeatherSrvc){var deferred=$q.defer();return WeatherSrvc.loadWeather(51.054398,3.725224,"metric").then(function(data){deferred.resolve(data)},function(error){deferred.reject(error)}),deferred.promise}],function(){var controllers=angular.module("ddsApp.controllers");controllers.controller("ddsApp.controllers.MainCtrl",["$scope","weather",function($scope,weather){console.log(weather)}])}(),function(){var services=angular.module("ddsApp.services");services.factory("ddsApp.services.WeatherSrvc",["$rootScope","$http","$q","localStorageService",function($rootScope,$http,$q){var URLWEATHER="http://api.openweathermap.org/data/2.5/weather?lat={0}&lon={1}&mode=json&units={2}&callback=JSON_CALLBACK",MSGWEATHERLOADERROR="Could not load the Weather call";return{loadConfiguration:function(){var deferred=$q.defer();return deferred.resolve(!0),deferred.promise},loadWeather:function(lat,long,units){var deferred=$q.defer(),url=URLWEATHER.format(lat,long,units);return $http.jsonp(url).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject(MSGWEATHERLOADERROR)}),deferred.promise}}}])}();